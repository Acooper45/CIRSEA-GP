---
title: "NRE_Final_Project"
author: "Chloe Swick"
date: "2023-12-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("devtools")
#install.packages("htmltools")
# devtools::install_github("james-thorson/FishLife")
# library("FishLife")
```


```{r}
# vignette("tutorial","FishLife")
```


# Stage 1--> Traditional Enforcement 

## Stock Function
this function should describe how much fish stock there is (birth minus death/harvest)

from the objective function we want to describe how what the optimal TAC should be (MSY)

How far above MSY are we currently? 

Shaefer Model: 

$$X_{t+1} = X_{t} + rX_{t}(1-X_{t}/K) - qX_t E_t$$

```{r}
objective <- function(effort, int_state, discount, p, c, r, K, q, period) {
  
  #vectors 
  stock <- vector(mode = "numeric", length = period+1)
  benefits <- vector(mode = "numeric", length = period+1)
 # choice <- vector(mode = "numeric", length = 50)
  
  #initial values
  stock[1] = int_stock
  benefits[1] = p * q * stock[1] * effort[1] - c * ((effort[1])^2)
 
  
  #for loop
  for (i in 2:(period+1))  #can write this as 'length(choice)', will be 50 because we are going to have 50 values of e
    {
    ### Stock dynamics
    stock[i] = stock[i-1] + r * stock[i-1] * (1 - (stock[i-1]/K)) - q * stock[i-1] * effort[i-1]
  
   # X_{t+1} = X_{t} + rX_{t}(1-X_{t}/K) - qX_t E_t
    benefits[i] = p * q * stock[i] * effort[i] - c * ((effort[i])^2)    
    
  }
  
  t = seq(from = 0, period) 
  pv = ((1/(1 + discount))^t) * benefits
  npv = sum(pv)
  
  return(-npv)
  
}
```

## Illegal fishing / enforcement 

Model how much of total fishing is illegal fishing. this will be a function of what TAC is set at, and what enforcement/deterrence levels are

more enforcement will lead to less IUU, and get us closer to TAC

enforcement also costs money, the more money you spend on enforcement, the less you have for other things, or enforcement in other areas 

## Optimization 

how much enforcement is optimal? how do we get the highest NPV? (benefit is amount of legal fish landed, cost is cost of enforcement, want to minimize catch)

constraints--> 
1. catch > or equal to TAC 
2. enforcement costs < or equal to enforcement budget 

```{r}
### Define the constraint function

### Constraint 1: Stock cannot exceed carrying capacity K
constraint1 <- function(effort, int_state, discount, p, c, r, K, q, period){

  stock <- vector(mode = "numeric", length = period+1)
  
  ### Initial states
  stock[1] = int_stock
  
  ### For-loop
  for(i in 2:length(period+1)){
    
    stock[i] = stock[i-1] + r * stock[i-1] * (1 - (stock[i-1]/K)) - q * stock[i-1] * effort[i-1]
  
  } # End for-loop
  
  const1 = stock[i] - K
  
  return(const1)
  
} # End first constraint function



### Constraint 2: Harvest cannot exceed TAC (MSY)
constraint2 <- function(effort, int_state, discount, p, c, r, K, q, period){

  stock <- vector(mode = "numeric", length = period+1)
  
  ### Initial states
  stock[1] = int_stock
  
  ### For-loop
  for(i in 2:length(period+1)){
    
    stock[i] = stock[i-1] + r * stock[i-1] * (1 - (stock[i-1]/K)) - q * stock[i-1] * effort[i-1]
  
  } # End for-loop
  
  ### MSY for the Indian Ocean yellowfin stock is 403,000 MT (Naunet Fisheries Consultants, 2021)
  
  const2 = q * stock[i-1] * effort[i-1] - 403000
  
  return(const2)
  
} # End first constraint function

```

# Stage 2--> Enforcement with Skylight 

## optimization 

questions: 
1. can TAC be reached with budget constraint? 
  if not, how effective does Skylight need to be to reach TAC? 
  if yes, how much money is saved in reaching TAC w/ Skylight 
          how much faster can TAC be reached? 
          
2. How do these results change when we have different effectiveness ratings for Skylight? 














